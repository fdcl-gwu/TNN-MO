import numpy as np
from mpl_toolkits.mplot3d.art3d import Poly3DCollection
import matplotlib.pyplot as plt
from .Qplot.bodies import transform_vertices_groups
from .Qplot.bodies import *


z0 = -0.00
# x = [-2.15688, -1.99369,        0,  1.99369,  2.15688,   -1.08,    -1.08,   -0.405,    0.295,   0.295,  -0.405,   -0.405,   -1.08,   -1.08,  -1.897, -1.897]
# y = [ 2.87891,  2.84979,  2.84979,  2.84979,  2.84979, 2.84979,  2.84979,  2.84979,  2.84979, 2.84979, 2.84979,  2.84979, 2.84979, 2.84979, 2.84979, 2.84979]
# z = [       0,  1.45856,  1.50836,  1.45856,        0,       0, 0.636866, 0.636866, 0.636866, 1.24095, 1.24095, 0.636866,0.636866, 1.32992, 1.32993, 0]
# vertices2 = [list[zip[x,y,z]]]
vertices1 = [[[-2.15688, 2.87891, z0],[-1.99369, 2.84979, 1.45856],[0, 2.84979, 1.50836],[1.99369, 2.84979, 1.45856],[2.15688, 2.84979, z0],
             [-1.08, 2.84979, z0],[-1.08,   2.84979, 0.636866],[-0.405, 2.84979, 0.636866], [0.295, 2.84979, 0.636866], [0.295, 2.84979, 1.24095],
             [-0.405, 2.84979, 1.24095],[-0.405,   2.84979, 0.636866],[-1.08, 2.84979, 0.636866], [-1.08, 2.84979, 1.32992], [-1.897, 2.84979, 1.32992],
             [-1.897, 2.84979, z0]]]
            # [[-3.15356, 3.8, -0.229866], [-3.15356, 3.1537, -0.229866], [-3.34964, 2.87926, 0], 
            #   [-3.15356, -2.84979, 0], [-3.15356, -2.84979, -0.74621], [-3.10537, -2.70818, -1.88011], [-2.90129, -2.59566, -2.58],
            #   [-3.15356, 3.8,-2.58], [-3.15356, 3.8,-1.88011], [-3.15356, 3.8,-0.74621], [-3.15356, 3.8,-2.559]],
            # [[3.15356, 3.8, -0.229866], [3.15356, 3.1537, -0.229866], [3.34964, 2.87926, 0], 
            #   [3.15356, -2.84979, 0], [3.15356, -2.84979, -0.74621], [3.10537, -2.70818, -1.88011], [2.90129, -2.59566, -2.58],
            #   [3.15356, 3.8,-2.58], [3.15356, 3.8,-1.88011], [3.15356, 3.8,-0.74621], [3.15356, 3.8,-2.559]]]

# x = [-2.92877, 2.92877, 3.03623, -3.03623, -2.92877, -2.77387, -2.85914, 2.80772, 2.71383, -2.77387]
# y = [-2.48433,-2.48433,   2.657,    2.657, -2.48433, -2.35845,  2.48561, 2.43857,-2.39763, -2.35845]
# z = [       0,       0,       0,        0,        0,        0,        0,       0,       0,        0]
# vertices3 = [list[zip[x,y,z]]]
vertices2 = [[[-2.92877, -2.5433, z0], [2.92877, -2.5433, z0], [3.03623, 2.657, z0],[-3.03623, 2.657, z0],[-2.92877, -2.48433, z0],
             [-2.77387, -2.35845, z0],[-2.85914,   2.48561, z0],[2.80772, 2.48561, z0], [2.71383, -2.39763, z0], [-2.77387, -2.35845, z0]],
             [[-0.085194, 2.657, z0],[-0.085194, -2.5433, z0],[0.085194, -2.5433, z0],[0.085194, 2.657, z0]],
             [[-0.080194, 0.941348, z0],[-0.415431, 0.846016, z0],[-0.686867, 0.641863, z0], [-0.8677, 0.354888, 0],[-0.932745, 0.011091, z0], 
              [-0.864806, -0.335297, z0],[-0.681218, -0.620632, z0], [-0.408537, -0.8212, z0], [-0.085194, -0.913277 , z0],
              [-0.085194, -0.77924, z0],[-0.357171, -0.697438, z0],[-0.587013, -0.524948 , z0],[-0.74133, -0.281791, z0],[-0.798224, 0.012018, z0],
              [-0.743442, 0.303809, z0],[-0.591262, 0.548001, z0],[-0.362555, 0.723025 , z0],[-0.085194, 0.807311, z0]],
             [[0.080194, 0.941348, z0],[0.415431, 0.846016, z0],[0.686867, 0.641863, z0], [0.8677, 0.354888, z0],[0.932745, 0.011091, z0], 
              [0.864806, -0.335297, z0],[0.681218, -0.620632, z0],[0.408537, -0.8212, z0], [0.085194, -0.913277 , z0],
              [0.085194, -0.77924, z0],[0.357171, -0.697438, z0],[0.587013, -0.524948 , z0],[0.74133, -0.281791, z0],[0.798224, 0.012018, z0],
              [0.743442, 0.303809, z0],[0.591262, 0.548001, z0],[0.362555, 0.723025 , z0],[0.085194, 0.807311, z0]]]

vertices3 = [[[-3.15356, -2.84979, z0],[3.15356, -2.84979, z0],[3.34964, 2.87926, z0],[-3.34964, 2.87926, z0],[-3.15356, -2.84979, z0],
             [-2.92877, -2.5433, z0],[-3.03623,   2.657, z0],[3.03623, 2.657, z0], [2.92877, -2.5433, z0], [-2.92877, -2.5433, z0]],
            [[-0.085194, -2.37768, z0],[-2.77387, -2.35845, z0], [-2.85914,   2.48561, z0], [-0.085194, 2.48561, z0],
              [-0.080194, 0.941348, z0],[-0.415431, 0.846016, z0],[-0.686867, 0.641863, z0], [-0.8677, 0.354888, z0],[-0.932745, 0.011091, z0], 
              [-0.864806, -0.335297, z0],[-0.681218, -0.620632, z0], [-0.408537, -0.8212, z0], [-0.085194, -0.913277 , z0]],
            [[0.085194, -2.37768, z0],[2.77387, -2.35845, z0], [2.85914,   2.48561, z0], [0.085194, 2.48561, z0],
              [0.085194, 0.941348, z0],[0.415431, 0.846016, z0],[0.686867, 0.641863, z0], [0.8677, 0.354888, z0],[0.932745, 0.011091, z0], 
              [0.864806, -0.335297, z0],[0.681218, -0.620632, z0], [0.408537, -0.8212, z0], [0.085194, -0.913277 , z0]],
            [[-0.085194, 0.807311, z0], [-0.362555, 0.723025 , z0], [-0.591262, 0.548001, z0], [-0.743442, 0.303809, z0],[-0.798224, 0.012018, z0],
              [-0.74133, -0.281791, z0], [-0.587013, -0.524948 , z0],[-0.357171, -0.697438, z0],[-0.085194, -0.77924, z0]],
            [[0.085194, 0.807311, z0], [0.362555, 0.723025 , z0], [0.591262, 0.548001, z0], [0.743442, 0.303809, z0],[0.798224, 0.012018, z0],
              [0.74133, -0.281791, z0], [0.587013, -0.524948 , z0],[0.357171, -0.697438, z0],[0.085194, -0.77924, z0]]]

vertices4 = [[[-3.15356, -2.84979, z0],[-3.15457 , -2.85081 , -0.74621 ],[-3.08588 , -2.68943 , -1.80533 ],[-2.91026 ,-2.5877, -2.58157 ],
              [0 , -2.57398 , -2.56774 ],[0, -2.71668, -1.62451],[0, -2.85064 , -0.616632],[0,   -2.84979 , z0],[-3.15356, -2.84979, z0]],
              [[3.15356, -2.84979, z0],[3.15457 , -2.85081 , -0.74621 ],[3.08588 , -2.68943 , -1.80533 ],[2.91026 ,-2.5877, -2.58157 ],
              [0 , -2.57398 , -2.56774 ],[0, -2.71668, -1.62451],[0, -2.85064 , -0.616632],[0,   -2.84979 , z0],[-3.15356, -2.84979, z0]],
              [[-3.15356, -2.84979, z0],[-3.15457 , -2.85081 , -0.74621 ],[-3.08588 , -2.68943 , -1.80533 ],[-2.91026 ,-2.5877, -2.58157],
              [-3.14887  , 2.7995 , -2.58009 ],[-3.36838 , 10.5214, -2.5717],[-3.32692 , 14.9987 , -2.56683],[-2.59234,  20.9949 , -2.56031 ],
              [-1.16316 , 25.5974 , -2.55531 ],[-0.324004  , 28.4765 , -2.55218],[0 , 29.1861 , -2.54081 ],[0,  30.6169  , 0.954002],
              [0,  30.6169  , 0.954002],[-1.08331,29.4329 , 0.886197],[-2.26716 , 26.8575, 0.627521],[-3.25221,  22.3042, 0.358402],[-3.56941,  17.1472  , 0.05941],
              [-3.52321,  10.3943 , -0.138438 ],[-3.43109, 5.51337, -0.217132],[-3.35813 , 3.1537, -0.229866],[-3.35005,  2.87927, z0],[-3.15356,  -2.84979 , z0]],
              [[3.15356, -2.84979, z0],[3.15457 , -2.85081 , -0.74621 ],[3.08588 , -2.68943 , -1.80533 ],[2.91026 ,-2.5877, -2.58157],
              [3.14887  , 2.7995 , -2.58009 ],[3.36838 , 10.5214, -2.5717],[3.32692 , 14.9987 , -2.56683],[2.59234,  20.9949 , -2.56031 ],
              [1.16316 , 25.5974 , -2.55531 ],[0.324004  , 28.4765 , -2.55218],[0 , 29.1861 , -2.54081 ],[0,  30.6169  , 0.954002],
              [0,  30.6169  , 0.954002],[1.08331,29.4329 , 0.886197],[2.26716 , 26.8575, 0.627521],[3.25221,  22.3042, 0.358402],[3.56941,  17.1472  , 0.05941],
              [3.52321,  10.3943 , -0.138438 ],[3.43109, 5.51337, -0.217132],[3.35813 , 3.1537, -0.229866],[3.35005,  2.87927, z0],[3.15356,  -2.84979 , z0]],
              [[0,  30.0411, -0.061451],[-0.831369, 29.4329, -0.138447 ],[-2.05073, 26.8575, -0.189162],[-3.19449,  22.3042, -0.255361 ],[-3.49759, 17.1472, -0.411827 ],
               [-3.45268 ,  10.3943, -0.632015],[-3.43109, 5.51337, -0.670985],[-3.35813 , 3.1537, -0.677047],[-3.35005,  2.87927, z0],[-2.15921,  2.87927, z0],[-2.23617,  3.64382 , -0.653995],
               [-2.23594, 19.0664, -0.384968],[-1.52389, 19.7683, -0.328382],[0, 19.7683, -0.328382],[0,  30.0411, -0.061451]],
              [[0,  30.0411, -0.061451],[0.831369, 29.4329, -0.138447 ],[2.05073, 26.8575, -0.189162],[3.19449,  22.3042, -0.255361 ],[3.49759, 17.1472, -0.411827 ],
               [3.45268 ,  10.3943, -0.632015],[3.43109, 5.51337, -0.670985],[3.35813 , 3.1537, -0.677047],[3.35005,  2.87927, z0],[2.15921,  2.87927, z0],[2.23617,  3.64382 , -0.653995],
               [2.23594, 19.0664, -0.384968],[1.52389, 19.7683, -0.328382],[0, 19.7683, -0.328382],[0,  30.0411, -0.061451]],
              [[-2.15921,  2.87927, z0],[-2.23617,  3.64382 , -0.653995],[-2.23594, 19.0664, -0.384968],[-2.00901 , 18.3145, 1.59101],[-1.99369 , 2.85333, 1.45856], [-2.15921,  2.87927, z0]],
              [[0 , 19.0201, 1.63325],[-1.3099, 19.0201, 1.63325],[-2.00901 , 18.3145, 1.59101],[-1.99369 , 2.85333, 1.45856],[0 , 2.85333, 1.50836 ]],
              [[-2.23594, 19.0664, -0.384968],[-1.52389 , 19.7683, -0.328382],[-1.3099, 19.0201, 1.63325],[-2.00901 , 18.3145, 1.59101]],
              [[-1.52389 , 19.7683, -0.328382],[0 , 19.7683, -0.328382],[0 , 19.0201, 1.63325],[-1.3099, 19.0201, 1.63325]],
              [[2.15921,  2.87927, z0],[2.23617,  3.64382 , -0.653995],[2.23594, 19.0664, -0.384968],[2.00901 , 18.3145, 1.59101],[1.99369 , 2.85333, 1.45856], [2.15921,  2.87927, z0]],
              [[0 , 19.0201, 1.63325],[1.3099, 19.0201, 1.63325],[2.00901 , 18.3145, 1.59101],[1.99369 , 2.85333, 1.45856],[0 , 2.85333, 1.50836 ]],
              [[2.23594, 19.0664, -0.384968],[1.52389 , 19.7683, -0.328382],[1.3099, 19.0201, 1.63325],[2.00901 , 18.3145, 1.59101]],
              [[1.52389 , 19.7683, -0.328382],[0 , 19.7683, -0.328382],[0 , 19.0201, 1.63325],[1.3099, 19.0201, 1.63325]]
              ]              
# [[-2.15921,  2.87927, z0],[-2.23617,  3.64382 , -0.653995],[-2.00901 , 18.3145, 1.59101],[-1.99369 , 2.85333, 1.45856], [-2.15921,  2.87927, z0]]              
def ship3D(ax, **kwargs):
    #poly = Poly3DCollection(vertices, alpha=0.4, color = "black")
    poly1 = Poly3DCollection(transform_vertices_groups(vertices1,**kwargs), alpha=0.5, color = "gray")
    poly2 = Poly3DCollection(transform_vertices_groups(vertices2,**kwargs), alpha=0.2, color = "white")
    poly3 = Poly3DCollection(transform_vertices_groups(vertices3,**kwargs), alpha=0.5, color = "black")
    poly4 = Poly3DCollection(transform_vertices_groups(vertices4,**kwargs), alpha=0.2, color = "gray")
    #ax.add_collection3d(poly)
    ax.add_collection3d(poly1)
    ax.add_collection3d(poly2)
    ax.add_collection3d(poly3)
    ax.add_collection3d(poly4)

    # w1 = np.array([0,0,0])#kwargs['ane1']
    # try:
    #     w1=kwargs['base_ane']
    # except:
    #     pass
    
    PlotBowWind(ax, **kwargs)

def sea3D(ax):
    c=80
    x = [-c,c,c,-c]
    y = [-c,-c,c,c]
    z = [-2,-2,-2,-2]
    verts = [list(zip(x,y,z))]
    poly1 = Poly3DCollection(verts, alpha=0.1, color = "blue")
    ax.add_collection3d(poly1)


def PlotBowWind(ax, **kwargs):
    # Anemometer wind directions
    try:
        w1=kwargs['base_ane']
        P_0 = np.array([0,31.5,2.5]) #transform_wind(np.array([0,10,0]), np.array([0,10,0]), **kwargs)
        P_1 = np.array([[0,-1,0],[-1,0,0],[0,0,-1]]) @ w1 #transform_wind(w1, np.array([0,0,0]), **kwargs)
        plotArrow3Dr(ax, P=P_0, Q=P_1,size=7,color='green',label='Bow Anemometer (avg.)')
    except:
        pass
    

